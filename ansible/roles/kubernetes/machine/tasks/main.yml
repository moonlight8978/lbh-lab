---
- name: Configure sysctl
  loop:
    - {name: fs.inotify.max_user_instances, value: "8192"}
    - {name: fs.inotify.max_user_watches, value: "524288"}
    - {name: net.ipv6.conf.all.disable_ipv6, value: "1"}
    - {name: net.ipv6.conf.default.disable_ipv6, value: "1"}
    - {name: net.ipv6.conf.lo.disable_ipv6, value: "1"}
    - {name: vm.nr_hugepages, value: "1024"}
  ansible.builtin.sysctl:
    name: "{{ item.name }}"
    value: "{{ item.value }}"
    sysctl_set: true
    reload: true
    sysctl_file: /etc/sysctl.d/99-kubernetes.conf
